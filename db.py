import cv2
import os
import numpy as np
import tkinter as tk
from tkinter import ttk
from tkinter import messagebox
from datetime import datetime
import csv
from deepface import DeepFace
from pinecone import Pinecone


pc = Pinecone(api_key="pcsk_2J7EVG_627jkBdNjsMmk9HQrSgrDLet68txQzv3R4dvy4kWePXSQ3tLcWL2emAg2f9iKjf", environment="us-east-1")
face_cascade = cv2.CascadeClassifier(cv2.data.haarcascades + "haarcascade_frontalface_default.xml")

def insert_into_db(record):

    #pc = Pinecone(api_key="pcsk_2J7EVG_627jkBdNjsMmk9HQrSgrDLet68txQzv3R4dvy4kWePXSQ3tLcWL2emAg2f9iKjf", environment="us-east-1")

    index_name = "frs"
    if not pc.has_index(index_name):
        pc.create_index_for_model(
            name=index_name,
            cloud="aws",
            region="us-east-1",
            embed={
                "model":"llama-text-embed-v2",
                "field_map":{"text": "chunk_text"}
            }
        )
    dense_index = pc.Index(index_name)
    dense_index.upsert(vectors=record, namespace="__default__")



face_img="face_database/Jahanvee/jahanvee5.jpg"
embedding = DeepFace.represent(face_img,model_name="ArcFace")
embeddings = embedding[0]["embedding"]
embedding_dict = dict()
embedding_dict['id'] = "Sekra_1"
embedding_dict["values"] = embeddings
emb_list=list()
emb_list.append(embedding_dict)
print(emb_list)


#record = [{'id':'Bhoomika_1','values': [0.01627289317548275, 0.23228377103805542, 0.03601594641804695, -0.17454944550991058, 0.255444198846817, -0.13593457639217377, -0.09332229197025299, 0.06176165118813515, -0.04660716652870178, -0.18642069399356842, -0.03735660761594772, -0.007089509163051844, -0.22205428779125214, -0.16193701326847076, -0.04816561937332153, 0.18576227128505707, -0.10432716459035873, 0.10257793217897415, -0.16719838976860046, -0.30927765369415283, -0.33676525950431824, 0.047497596591711044, -0.15567058324813843, -0.029492754489183426, -0.06456460058689117, 0.0064895423129200935, 0.033226072788238525, 0.2700234353542328, 0.12286921590566635, 0.03854002803564072, -0.12581875920295715, 0.13873612880706787, 0.03653287887573242, 0.3533534109592438, 0.20813342928886414, -0.3654782474040985, 0.17417418956756592, 0.13498429954051971, -0.034393444657325745, 0.2552200257778168, 0.041013188660144806, 0.002041457686573267, -0.029069334268569946, -0.3323836624622345, -0.2046588659286499, -0.15660718083381653, 0.1316211074590683, 0.21469154953956604, -0.04885677993297577, 0.19685041904449463, -0.16471758484840393, -0.090225949883461, 0.0661981999874115, -0.04356760531663895, 0.1985594630241394, 0.0016743876039981842, 0.22591248154640198, 0.06215997785329819, 0.22171472012996674, 0.2645610272884369, -0.1266857087612152, -0.06169773265719414, 0.02628309652209282, 0.007335820235311985, -0.10619116574525833, 0.04986570030450821, 0.09711529314517975, -0.2389737218618393, -0.09073098003864288, 0.005131051875650883, -0.011521345004439354, 0.38913673162460327, 0.029475882649421692, -0.09920195490121841, 0.00912872701883316, 0.0412076972424984, 0.3436146378517151, -0.21096612513065338, 0.03947966545820236, -0.2506319284439087, -0.05842070281505585, -0.07533133029937744, -0.025784745812416077, -0.0008444169070571661, -0.11457619816064835, 0.24310395121574402, -0.10428714752197266, -0.08874665945768356, 0.13180363178253174, 0.0610240176320076, 0.2303215116262436, -0.2065727561712265, 0.19517089426517487, 0.25765350461006165, -0.14999894797801971, -0.04417681321501732, -0.32201674580574036, -0.07580834627151489, -0.04626604914665222, -0.049690984189510345, 0.033445265144109726, -0.06494466960430145, 0.04035544395446777, -0.012150390073657036, 0.05734025314450264, 0.1742035150527954, 0.23515063524246216, -0.0676683783531189, 0.010776191018521786, -0.014858778566122055, -0.11137452721595764, 0.01932365819811821, -0.09206487238407135, 0.04483805596828461, 0.1622711420059204, 0.09595346450805664, 0.14422589540481567, 0.015452553518116474, -0.2633393406867981, 0.08433760702610016, -0.18320538103580475, -0.04217515140771866, 0.06455525755882263, 0.19245874881744385, 0.07967349141836166, 0.3543144464492798, -0.24118687212467194, -0.029492611065506935, -0.07946978509426117, -0.08374248445034027, -0.13519053161144257, -0.16967938840389252, 0.042886000126600266, -0.059008218348026276, 0.10777813196182251, 0.20173487067222595, 0.2733069658279419, 0.33461320400238037, 0.12371951341629028, 0.30052703619003296, -0.27228689193725586, 0.16348940134048462, -0.13542547821998596, -0.12528276443481445, 0.0041100019589066505, 0.011653396300971508, -0.11882742494344711, 0.04120596498250961, 0.10027219355106354, 0.10608669370412827, 0.20610105991363525, 0.3714534640312195, 0.03384881466627121, 0.21215687692165375, 0.1851898431777954, -0.031820982694625854, -0.1591019481420517, -0.2642350196838379, -0.1164621114730835, 0.12200598418712616, -0.15281479060649872, 0.058178871870040894, -0.10561633110046387, 0.0222337506711483, -0.08076191693544388, 0.12352989614009857, 0.11822815239429474, 0.011632321402430534, -0.14589549601078033, 0.17293953895568848, 0.21893543004989624, -0.28339675068855286, 0.022101277485489845, -0.1190229132771492, 0.04867364093661308, 0.09026655554771423, 0.18969117105007172, -0.09020353108644485, -0.2525429129600525, -0.387353777885437, -0.16173149645328522, -0.014718198217451572, -0.18723557889461517, -0.02959319017827511, 0.21807590126991272, -0.0184460561722517, -0.1510898321866989, -0.19456329941749573, -0.07625313103199005, -0.028638040646910667, 0.18174529075622559, -0.12707433104515076, -0.07919757068157196, 0.07654742896556854, -0.04003032296895981, 0.03694795072078705, 0.055825479328632355, -0.13544005155563354, 0.007618373725563288, -0.030752206221222878, 0.22537222504615784, 0.06844218075275421, 0.19169962406158447, -0.07147670537233353, -0.12749728560447693, 0.12313384562730789, 0.16391251981258392, 0.06512875854969025, -0.027454201132059097, 0.07511197030544281, 0.029303397983312607, -0.13855771720409393, 0.2888850271701813, -0.08943771570920944, 0.14368024468421936, 0.02711871825158596, 0.22558608651161194, 0.23659983277320862, 0.10626933723688126, 0.0354452058672905, -0.3067549765110016, -0.16380833089351654, -0.15793047845363617, -0.07801660895347595, 0.1393773853778839, 0.12473887950181961, 0.22768883407115936, 0.1218559667468071, -0.04155368357896805, -0.031561050564050674, 0.16241933405399323, -0.0764080062508583, 0.0096212737262249, -0.1222606971859932, 0.31319302320480347, -0.13663072884082794, -0.19040778279304504, -0.0380658321082592, -0.21370890736579895, 0.24762843549251556, 0.17251621186733246, -0.06187396124005318, 0.023537034168839455, 0.13648000359535217, -0.12483735382556915, 0.17501679062843323, 0.10888948291540146, 0.0036639850586652756, 0.07366926968097687, -0.08650219440460205, -0.06554204970598221, 0.08116273581981659, 0.014797870069742203, 0.3029853105545044, 0.07510372996330261, 0.20859204232692719, 0.019765157252550125, 0.17451748251914978, -0.07738743722438812, -0.13837161660194397, -0.07008418440818787, -0.07797245681285858, -0.07804808020591736, -0.22041362524032593, 0.16243109107017517, 0.026607709005475044, -0.12129335850477219, 0.02860502153635025, 0.040836840867996216, 0.06557969003915787, 0.2976682782173157, 0.3039269745349884, 0.20695635676383972, -0.14982670545578003, -0.14509521424770355, -0.07299141585826874, 0.13016676902770996, -0.006207876838743687, -0.15583482384681702, 0.3759143054485321, 0.1105910986661911, -0.01960381492972374, -0.08826152235269547, -0.15985728800296783, -0.186051145195961, -0.005267322063446045, 0.4271818697452545, -0.0035301658790558577, -0.14990711212158203, 0.10308648645877838, -0.06262190639972687, 0.06651193648576736, 0.05425023287534714, -0.18255752325057983, 0.1494331657886505, 0.05166500806808472, -0.050046999007463455, 0.14190858602523804, -0.32667049765586853, 0.02598208375275135, 0.08398926258087158, 0.05979708209633827, 0.0456232875585556, 0.0312928706407547, 0.15762345492839813, 0.07365526258945465, -0.04663683846592903, -0.07563723623752594, 0.11691980063915253, -0.27444902062416077, -0.15934303402900696, 0.01634550467133522, -0.09081227332353592, 0.11944656819105148, -0.0017488505691289902, 0.0926453247666359, -0.02046167105436325, -0.03006014972925186, 0.029549285769462585, -0.0592954158782959, 0.13445304334163666, 0.27407926321029663, 0.048617810010910034, 0.21477355062961578, 0.18945585191249847, -0.11652620881795883, 0.24817398190498352, 0.09589546918869019, -0.0017301682382822037, 0.007549267262220383, 0.09850415587425232, 0.15053313970565796, -0.27412164211273193, 0.08161728084087372, -0.29113367199897766, -0.04651059955358505, 0.27307555079460144, 0.096611388027668, 0.1550717055797577, 0.032774217426776886, -0.25938817858695984, 0.09235171228647232, -0.07889828085899353, 0.2904357314109802, -0.03923685476183891, -0.14846554398536682, 0.47516757249832153, 0.09674226492643356, 0.13173310458660126, 0.0028931894339621067, -0.00433727353811264, -0.1534234881401062, -0.21035465598106384, 0.08567968755960464, -0.09172128885984421, 0.010627221316099167, -0.14226144552230835, 0.10165472328662872, 0.08776836097240448, -0.023567918688058853, 0.12203298509120941, -0.07179081439971924, 0.18507087230682373, -0.09990070760250092, 0.0077572958543896675, -0.045483216643333435, -0.02462220937013626, 0.34255900979042053, 0.2708771824836731, 0.08495271950960159, 0.13364577293395996, -0.09693335741758347, 0.26411864161491394, 0.18845497071743011, 0.1446814239025116, -0.13376401364803314, 0.045834146440029144, 0.26509255170822144, -0.29556459188461304, -0.029993511736392975, 0.4567643404006958, -0.03746488690376282, -0.20239244401454926, 0.1862882524728775, 0.04949707165360451, 0.05987388640642166, -0.3059243857860565, 0.21899163722991943, -0.0908166915178299, -0.08467525243759155, 0.42927101254463196, -0.35515713691711426, 0.03762836009263992, -0.009246066212654114, 0.1275477260351181, 0.00876624509692192, 0.06648034602403641, -0.12982936203479767, 0.10830258578062057, 0.32771527767181396, -0.21044887602329254, -0.07351873815059662, -0.1066473126411438, -0.10235371440649033, -0.10775422304868698, 0.19049328565597534, -0.2324986755847931, -0.016682563349604607, -0.1293509155511856, -0.010817443020641804, -0.13144241273403168, -0.01365038100630045, 0.050107501447200775, -0.2465069591999054, 0.1770273745059967, 0.11639630049467087, -0.028875745832920074, -0.010806549340486526, 0.07190271466970444, -0.12843795120716095, -0.02286003716289997, 0.06626178324222565, 0.026884229853749275, -0.18430763483047485, 0.19712936878204346, 0.007675670087337494, -0.12863443791866302, -0.024142351001501083, 0.012174393981695175, 0.3015645146369934, -0.0402824804186821, 0.13684490323066711, 0.197150319814682, -0.030097875744104385, -0.05657483637332916, -0.3155406713485718, -0.026403721421957016, 0.0985410213470459, -0.14470326900482178, -0.14744199812412262, 0.02834370732307434, 0.03046499937772751, -0.007368432357907295, -0.012858089059591293, -0.011626077815890312, 0.10699392110109329, 0.22364135086536407, -0.08678247034549713, 0.05786623805761337, -0.2537486255168915, 0.019916819408535957, -0.278795450925827, -0.09136821329593658, -0.12484274804592133, 0.06393194943666458, -0.013316511176526546, -0.4278062582015991, -0.26148146390914917, 0.0804741159081459, -0.012960397638380527, 0.040751706808805466, -0.021067775785923004, -0.056563809514045715, 0.0823495015501976, 0.0374598428606987, -0.020741572603583336, 0.15870441496372223, 0.07717271894216537, -0.03690027445554733, -0.18245269358158112, 0.0027245706878602505, 0.21775534749031067, 0.014846946112811565, 0.16442078351974487, 0.1456073373556137, 0.129707470536232, -0.1586512178182602, -0.09770502150058746, 0.19205355644226074, 0.022352688014507294, -0.18000757694244385, -0.04897783324122429, -0.04784896969795227, 0.13072077929973602, -0.09890484809875488, -0.2802625596523285, -0.13841941952705383, -0.20549631118774414, 0.3088805079460144, -0.1029638946056366, -0.07279461622238159, -0.17353257536888123, 0.23675021529197693, -0.16287866234779358, -0.06816169619560242, 0.17685328423976898, 0.3041962683200836, 0.17127585411071777, 0.03379148244857788, 0.01077080424875021, 0.11996536701917648, -0.1139020025730133, 0.34083321690559387, -0.18587693572044373, 0.18063421547412872, 0.05937197059392929, -0.10074196755886078, -0.10312963277101517, 0.018148742616176605, 0.43242180347442627, -0.008298853412270546, 0.4087033271789551]}]

#insert_into_db(record)